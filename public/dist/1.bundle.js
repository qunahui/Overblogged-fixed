(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{174:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),r=n(1),o=d(r),l=n(471),i=n(612),u=d(n(613)),s=n(59);n(614);var c=d(n(615));function d(t){return t&&t.__esModule?t:{default:t}}function p(t){return function(){var e=t.apply(this,arguments);return new Promise((function(t,n){return function a(r,o){try{var l=e[r](o),i=l.value}catch(t){return void n(t)}if(!l.done)return Promise.resolve(i).then((function(t){a("next",t)}),(function(t){a("throw",t)}));t(i)}("next")}))}}var m=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));f.call(n);var a=l.EditorState.createEmpty();if(t.blog){var r=(0,c.default)(t.blog.content),o=l.ContentState.createFromBlockArray(r.contentBlocks);a=l.EditorState.createWithContent(o)}return n.state={isUpdating:!!t.isUpdating,description:t.blog?t.blog.description:"",editorState:a,htmlMeta:t.blog?t.blog.meta:[],htmlContent:t.blog?t.blog.content:null,title:t.blog?t.blog.title:"",thumbnail:t.blog?t.blog.thumbnail:null},n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),a(e,[{key:"componentDidMount",value:function(){this.props.isUpdating&&console.log(this.state)}},{key:"render",value:function(){var t=this.state.editorState;return o.default.createElement("form",{onSubmit:this.onSubmit},o.default.createElement("div",{className:"input-group"},o.default.createElement("label",null,"Add title for your blog: "),o.default.createElement("input",{type:"text",value:this.state.title,onChange:this.handleTitleChange}),this.state.title?o.default.createElement("p",{className:"inlineMessage__success"},"Saved!"):null),o.default.createElement("div",{className:"input-group"},o.default.createElement("label",null,"Add description for your blog: "),o.default.createElement("input",{type:"text",value:this.state.description,onChange:this.handleDescriptionChange}),this.state.description?o.default.createElement("p",{className:"inlineMessage__success"},"Saved!"):null),o.default.createElement("div",{className:"input-group"},o.default.createElement("label",null,"Add your thumbnail for your blog: "),o.default.createElement("input",{type:"file",onChange:this.handleThumbNailChange}),this.state.thumbnail?o.default.createElement("p",{className:"inlineMessage__success"},"Saved!"):null),o.default.createElement("div",{className:"input-group",id:"meta-group"},o.default.createElement("label",null,"Add meta data for your blog: "),o.default.createElement("input",{type:"hidden",value:"1",id:"total_meta"}),o.default.createElement("button",{onClick:this.add,className:"button button--darkpink button-small"},"Add"),o.default.createElement("button",{onClick:this.remove,className:"button button--darkpink button-small"},"Remove")),o.default.createElement(i.Editor,{placeholder:"Create your blog here....",editorState:t,wrapperClassName:"demo-wrapper",editorClassName:"demo-editor editor-border",onEditorStateChange:this.onEditorStateChange,toolbar:{image:{previewImage:!0,uploadEnabled:!0,uploadCallback:this.uploadCallback}},toolbarStyle:{color:"black",position:"fixed",left:"10vw",top:"30vh",width:"20%"}}),o.default.createElement("button",{className:"button button-pinkwhite"},"Save blog"))}}]),e}(r.Component),f=function(){var t,e,n,a=this;this.onEditorStateChange=function(t){var e=(0,u.default)((0,l.convertToRaw)(t.getCurrentContent()));a.setState({editorState:t,htmlContent:e})},this.uploadImg=(t=p(regeneratorRuntime.mark((function t(e){var n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.name+"__"+Date.now(),r=void 0,t.next=4,s.storage.ref("images/"+n).put(e);case 4:return t.next=6,s.storage.ref("images").child(n).getDownloadURL().then((function(t){r=t}));case 6:return t.abrupt("return",r);case 7:case"end":return t.stop()}}),t,a)}))),function(e){return t.apply(this,arguments)}),this.uploadCallback=(e=p(regeneratorRuntime.mark((function t(e){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=void 0,t.next=3,a.uploadImg(e).then((function(t){n=t}));case 3:return t.abrupt("return",Promise.resolve({data:{link:n}}));case 4:case"end":return t.stop()}}),t,a)}))),function(t){return e.apply(this,arguments)}),this.handleTitleChange=function(t){a.setState({title:t.target.value})},this.handleDescriptionChange=function(t){a.setState({description:t.target.value})},this.handleThumbNailChange=function(t){t.preventDefault(),a.setState({thumbnail:t.target.files[0]}),console.log(t.target.files[0])},this.onSubmit=(n=p(regeneratorRuntime.mark((function t(e){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.preventDefault(),n=void 0,a.props.isUpdating){t.next=5;break}return t.next=5,a.uploadImg(a.state.thumbnail).then((function(t){n=t}));case 5:a.setMetaState(),a.props.onSubmit({description:a.state.description,content:a.state.htmlContent,meta:a.state.htmlMeta,title:a.state.title,thumbnail:a.props.isUpdating?a.state.thumbnail:n});case 7:case"end":return t.stop()}}),t,a)}))),function(t){return n.apply(this,arguments)}),this.add=function(t){t.preventDefault();var e=parseInt($("#total_meta").val())+1,n="<div id='meta_"+e+"'  class='input-group'><label>Name: </label> <input type='text' id='metaName_"+e+"' required/> <label>Content: </label> <input type='text' id='metaContent_"+e+"'required/></div>";$("#meta-group").append(n),$("#total_meta").val(e)},this.setMetaState=function(){for(var t=$("input[id^='metaName_']"),e=$("input[id^='metaContent_']"),n=[].concat(function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}(a.state.htmlMeta)),r=0;r<t.length;r++){var o={name:$(t[r]).val(),content:$(e[r]).val()};n.push(o)}a.setState({htmlMeta:n}),alert("saved")},this.remove=function(){var t=$("#total_meta").val();t>1&&($("#meta_"+t).remove(),$("#total_meta").val(t-1))}};e.default=m}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy9CbG9nRm9ybS5qcyJdLCJuYW1lcyI6WyJCbG9nRm9ybSIsInByb3BzIiwiZWRpdG9yU3RhdGUiLCJFZGl0b3JTdGF0ZSIsImNyZWF0ZUVtcHR5IiwiYmxvZyIsImNvbnRlbnRCbG9jayIsImNvbnRlbnQiLCJjb250ZW50U3RhdGUiLCJDb250ZW50U3RhdGUiLCJjcmVhdGVGcm9tQmxvY2tBcnJheSIsImNvbnRlbnRCbG9ja3MiLCJjcmVhdGVXaXRoQ29udGVudCIsInN0YXRlIiwiaXNVcGRhdGluZyIsImRlc2NyaXB0aW9uIiwiaHRtbE1ldGEiLCJtZXRhIiwiaHRtbENvbnRlbnQiLCJ0aXRsZSIsInRodW1ibmFpbCIsInRoaXMiLCJjb25zb2xlIiwibG9nIiwib25TdWJtaXQiLCJjbGFzc05hbWUiLCJ0eXBlIiwidmFsdWUiLCJvbkNoYW5nZSIsImhhbmRsZVRpdGxlQ2hhbmdlIiwiaGFuZGxlRGVzY3JpcHRpb25DaGFuZ2UiLCJoYW5kbGVUaHVtYk5haWxDaGFuZ2UiLCJpZCIsIm9uQ2xpY2siLCJhZGQiLCJyZW1vdmUiLCJFZGl0b3IiLCJwbGFjZWhvbGRlciIsIndyYXBwZXJDbGFzc05hbWUiLCJlZGl0b3JDbGFzc05hbWUiLCJvbkVkaXRvclN0YXRlQ2hhbmdlIiwidG9vbGJhciIsImltYWdlIiwicHJldmlld0ltYWdlIiwidXBsb2FkRW5hYmxlZCIsInVwbG9hZENhbGxiYWNrIiwidG9vbGJhclN0eWxlIiwiY29sb3IiLCJwb3NpdGlvbiIsImxlZnQiLCJ0b3AiLCJ3aWR0aCIsIkNvbXBvbmVudCIsImNvbnZlcnRUb1JhdyIsImdldEN1cnJlbnRDb250ZW50Iiwic2V0U3RhdGUiLCJ1cGxvYWRJbWciLCJmaWxlIiwiaWRlbnRpZnkiLCJuYW1lIiwiRGF0ZSIsIm5vdyIsImltZ1VSTCIsInN0b3JhZ2UiLCJyZWYiLCJwdXQiLCJjaGlsZCIsImdldERvd25sb2FkVVJMIiwidGhlbiIsInVybCIsInJlcyIsIlByb21pc2UiLCJyZXNvbHZlIiwiZGF0YSIsImxpbmsiLCJlIiwidGFyZ2V0IiwicHJldmVudERlZmF1bHQiLCJmaWxlcyIsInNldE1ldGFTdGF0ZSIsIm5ld19ubyIsInBhcnNlSW50IiwiJCIsInZhbCIsIm5ld19tZXRhIiwiYXBwZW5kIiwibmFtZV9pbnB1dHMiLCJjb250ZW50X2lucHV0cyIsImkiLCJsZW5ndGgiLCJwdXNoIiwiYWxlcnQiLCJsYXN0X2NocV9ubyJdLCJtYXBwaW5ncyI6Im9ZQUFBLE8sT0FDQSxTQUNBLFMsSUFDQSxRQUNBLFFBQ0EsT0FDQSxJLElBQUEsUSx3VkFFTUEsRSxZQUNGLFdBQVlDLEksNEZBQU8sZSxpS0FBQSx3REFDVEEsSUFEUyxVQUVmLElBQUlDLEVBQWNDLGNBQVlDLGNBQzlCLEdBQUlILEVBQU1JLEtBQU0sQ0FDWixJQUFNQyxHQUFlLGFBQVlMLEVBQU1JLEtBQUtFLFNBQ3RDQyxFQUFlQyxlQUFhQyxxQkFBcUJKLEVBQWFLLGVBQ3BFVCxFQUFjQyxjQUFZUyxrQkFBa0JKLEdBTmpDLE9BUWYsRUFBS0ssTUFBUSxDQUNUQyxhQUFjYixFQUFNYSxXQUNwQkMsWUFBYWQsRUFBTUksS0FBT0osRUFBTUksS0FBS1UsWUFBYyxHQUNuRGIsY0FDQWMsU0FBVWYsRUFBTUksS0FBT0osRUFBTUksS0FBS1ksS0FBTyxHQUN6Q0MsWUFBYWpCLEVBQU1JLEtBQU9KLEVBQU1JLEtBQUtFLFFBQVUsS0FDL0NZLE1BQU9sQixFQUFNSSxLQUFPSixFQUFNSSxLQUFLYyxNQUFRLEdBQ3ZDQyxVQUFXbkIsRUFBTUksS0FBT0osRUFBTUksS0FBS2UsVUFBWSxNQWZwQyxFLHFYQW1CZkMsS0FBS3BCLE1BQU1hLFlBQWFRLFFBQVFDLElBQUlGLEtBQUtSLFMsK0JBNEZwQyxJQUNHWCxFQUFnQm1CLEtBQUtSLE1BQXJCWCxZQUNSLE9BQ0ksZ0NBQU1zQixTQUFVSCxLQUFLRyxVQUNqQiwrQkFBS0MsVUFBVSxlQUNYLGtFQUNBLGlDQUFPQyxLQUFLLE9BQU9DLE1BQU9OLEtBQUtS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QWlCWGMsSUFBTSxTQUFDeUMsR0FDSEEsRUFBRUUsaUJBQ0YsSUFBSUcsRUFBU0MsU0FBU0MsRUFBRSxlQUFlQyxPQUFTLEVBQzVDQyxFQUFXLGlCQUFtQkosRUFBbkIsZ0ZBQ2tEQSxFQURsRCw0RUFFd0RBLEVBRnhELG9CQUlmRSxFQUFFLGVBQWVHLE9BQU9ELEdBRXhCRixFQUFFLGVBQWVDLElBQUlILEksS0FFekJELGFBQWUsV0FJWCxJQUhBLElBQUlPLEVBQWNKLEVBQUUsMEJBQ2hCSyxFQUFpQkwsRUFBRSw2QkFDbkJsRSxFQUFXQSxHQUFYQSxPLHNIQUFBQSxDQUFlLEVBQUtILE1BQU1HLFdBQ3JCd0UsRUFBSSxFQUFHQSxFQUFJRixFQUFZRyxPQUFRRCxJQUFLLENBQ3pDLElBQUl2RSxFQUFPLENBQUUwQyxLQUFNdUIsRUFBRUksRUFBWUUsSUFBSUwsTUFBTzVFLFFBQVMyRSxFQUFFSyxFQUFlQyxJQUFJTCxPQUMxRW5FLEVBQVMwRSxLQUFLekUsR0FFbEIsRUFBS3NDLFNBQVMsQ0FBRXZDLGFBQ2hCMkUsTUFBTSxVLEtBR1Z4RCxPQUFTLFdBQ0wsSUFBSXlELEVBQWNWLEVBQUUsZUFBZUMsTUFFL0JTLEVBQWMsSUFDZFYsRUFBRSxTQUFXVSxHQUFhekQsU0FDMUIrQyxFQUFFLGVBQWVDLElBQUlTLEVBQWMsTSxVQXdEaEM1RiIsImZpbGUiOiIxLmJ1bmRsZS5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCwgeyBDb21wb25lbnQgfSBmcm9tICdyZWFjdCc7XHJcbmltcG9ydCB7IEVkaXRvclN0YXRlLCBjb252ZXJ0VG9SYXcsIENvbnRlbnRTdGF0ZSB9IGZyb20gJ2RyYWZ0LWpzJztcclxuaW1wb3J0IHsgRWRpdG9yIH0gZnJvbSAncmVhY3QtZHJhZnQtd3lzaXd5Zyc7XHJcbmltcG9ydCBkcmFmdFRvSHRtbCBmcm9tICdkcmFmdGpzLXRvLWh0bWwnO1xyXG5pbXBvcnQgeyBzdG9yYWdlIH0gZnJvbSAnLi4vZmlyZWJhc2UvZmlyZWJhc2UnXHJcbmltcG9ydCAncmVhY3QtZHJhZnQtd3lzaXd5Zy9kaXN0L3JlYWN0LWRyYWZ0LXd5c2l3eWcuY3NzJztcclxuaW1wb3J0IGh0bWxUb0RyYWZ0IGZyb20gJ2h0bWwtdG8tZHJhZnRqcyc7XHJcblxyXG5jbGFzcyBCbG9nRm9ybSBleHRlbmRzIENvbXBvbmVudCB7XHJcbiAgICBjb25zdHJ1Y3Rvcihwcm9wcykge1xyXG4gICAgICAgIHN1cGVyKHByb3BzKTtcclxuICAgICAgICBsZXQgZWRpdG9yU3RhdGUgPSBFZGl0b3JTdGF0ZS5jcmVhdGVFbXB0eSgpO1xyXG4gICAgICAgIGlmIChwcm9wcy5ibG9nKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNvbnRlbnRCbG9jayA9IGh0bWxUb0RyYWZ0KHByb3BzLmJsb2cuY29udGVudCk7XHJcbiAgICAgICAgICAgIGNvbnN0IGNvbnRlbnRTdGF0ZSA9IENvbnRlbnRTdGF0ZS5jcmVhdGVGcm9tQmxvY2tBcnJheShjb250ZW50QmxvY2suY29udGVudEJsb2Nrcyk7XHJcbiAgICAgICAgICAgIGVkaXRvclN0YXRlID0gRWRpdG9yU3RhdGUuY3JlYXRlV2l0aENvbnRlbnQoY29udGVudFN0YXRlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5zdGF0ZSA9IHtcclxuICAgICAgICAgICAgaXNVcGRhdGluZzogISFwcm9wcy5pc1VwZGF0aW5nLFxyXG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogcHJvcHMuYmxvZyA/IHByb3BzLmJsb2cuZGVzY3JpcHRpb24gOiAnJyxcclxuICAgICAgICAgICAgZWRpdG9yU3RhdGUsXHJcbiAgICAgICAgICAgIGh0bWxNZXRhOiBwcm9wcy5ibG9nID8gcHJvcHMuYmxvZy5tZXRhIDogW10sXHJcbiAgICAgICAgICAgIGh0bWxDb250ZW50OiBwcm9wcy5ibG9nID8gcHJvcHMuYmxvZy5jb250ZW50IDogbnVsbCxcclxuICAgICAgICAgICAgdGl0bGU6IHByb3BzLmJsb2cgPyBwcm9wcy5ibG9nLnRpdGxlIDogJycsXHJcbiAgICAgICAgICAgIHRodW1ibmFpbDogcHJvcHMuYmxvZyA/IHByb3BzLmJsb2cudGh1bWJuYWlsIDogbnVsbCxcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBjb21wb25lbnREaWRNb3VudCgpIHtcclxuICAgICAgICB0aGlzLnByb3BzLmlzVXBkYXRpbmcgPyBjb25zb2xlLmxvZyh0aGlzLnN0YXRlKSA6IG51bGxcclxuICAgIH1cclxuICAgIG9uRWRpdG9yU3RhdGVDaGFuZ2UgPSAoZWRpdG9yU3RhdGUpID0+IHtcclxuICAgICAgICBjb25zdCBodG1sQ29udGVudCA9IGRyYWZ0VG9IdG1sKGNvbnZlcnRUb1JhdyhlZGl0b3JTdGF0ZS5nZXRDdXJyZW50Q29udGVudCgpKSlcclxuICAgICAgICB0aGlzLnNldFN0YXRlKHtcclxuICAgICAgICAgICAgZWRpdG9yU3RhdGUsXHJcbiAgICAgICAgICAgIGh0bWxDb250ZW50OiBodG1sQ29udGVudFxyXG4gICAgICAgIH0pXHJcbiAgICB9O1xyXG5cclxuICAgIHVwbG9hZEltZyA9IGFzeW5jIChmaWxlKSA9PiB7XHJcbiAgICAgICAgbGV0IGlkZW50aWZ5ID0gZmlsZS5uYW1lICsgJ19fJyArIERhdGUubm93KCk7XHJcbiAgICAgICAgbGV0IGltZ1VSTDtcclxuICAgICAgICBhd2FpdCBzdG9yYWdlLnJlZihgaW1hZ2VzLyR7aWRlbnRpZnl9YCkucHV0KGZpbGUpO1xyXG4gICAgICAgIGF3YWl0IHN0b3JhZ2UucmVmKCdpbWFnZXMnKS5jaGlsZChpZGVudGlmeSkuZ2V0RG93bmxvYWRVUkwoKS50aGVuKHVybCA9PiB7XHJcbiAgICAgICAgICAgIGltZ1VSTCA9IHVybDtcclxuICAgICAgICB9KVxyXG4gICAgICAgIHJldHVybiBpbWdVUkw7XHJcbiAgICB9XHJcblxyXG4gICAgdXBsb2FkQ2FsbGJhY2sgPSBhc3luYyAoZmlsZSkgPT4ge1xyXG4gICAgICAgIGxldCBpbWdVUkw7XHJcbiAgICAgICAgYXdhaXQgdGhpcy51cGxvYWRJbWcoZmlsZSkudGhlbihyZXMgPT4ge1xyXG4gICAgICAgICAgICBpbWdVUkwgPSByZXM7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh7IGRhdGE6IHsgbGluazogaW1nVVJMIH0gfSk7XHJcbiAgICB9XHJcblxyXG4gICAgaGFuZGxlVGl0bGVDaGFuZ2UgPSAoZSkgPT4ge1xyXG4gICAgICAgIHRoaXMuc2V0U3RhdGUoeyB0aXRsZTogZS50YXJnZXQudmFsdWUgfSlcclxuXHJcbiAgICB9XHJcblxyXG4gICAgaGFuZGxlRGVzY3JpcHRpb25DaGFuZ2UgPSAoZSkgPT4ge1xyXG4gICAgICAgIHRoaXMuc2V0U3RhdGUoeyBkZXNjcmlwdGlvbjogZS50YXJnZXQudmFsdWUgfSlcclxuICAgIH1cclxuXHJcbiAgICBoYW5kbGVUaHVtYk5haWxDaGFuZ2UgPSAoZSkgPT4ge1xyXG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKVxyXG4gICAgICAgIHRoaXMuc2V0U3RhdGUoeyB0aHVtYm5haWw6IGUudGFyZ2V0LmZpbGVzWzBdIH0pXHJcbiAgICAgICAgY29uc29sZS5sb2coZS50YXJnZXQuZmlsZXNbMF0pXHJcbiAgICB9XHJcblxyXG4gICAgb25TdWJtaXQgPSBhc3luYyAoZSkgPT4ge1xyXG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICBsZXQgdGh1bWJuYWlsO1xyXG4gICAgICAgIGlmICghdGhpcy5wcm9wcy5pc1VwZGF0aW5nKSB7XHJcbiAgICAgICAgICAgIGF3YWl0IHRoaXMudXBsb2FkSW1nKHRoaXMuc3RhdGUudGh1bWJuYWlsKS50aGVuKHJlcyA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aHVtYm5haWwgPSByZXM7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnNldE1ldGFTdGF0ZSgpO1xyXG4gICAgICAgIHRoaXMucHJvcHMub25TdWJtaXQoe1xyXG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogdGhpcy5zdGF0ZS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgY29udGVudDogdGhpcy5zdGF0ZS5odG1sQ29udGVudCxcclxuICAgICAgICAgICAgbWV0YTogdGhpcy5zdGF0ZS5odG1sTWV0YSxcclxuICAgICAgICAgICAgdGl0bGU6IHRoaXMuc3RhdGUudGl0bGUsXHJcbiAgICAgICAgICAgIHRodW1ibmFpbDogIXRoaXMucHJvcHMuaXNVcGRhdGluZyA/IHRodW1ibmFpbCA6IHRoaXMuc3RhdGUudGh1bWJuYWlsXHJcbiAgICAgICAgfSlcclxuICAgIH1cclxuICAgIGFkZCA9IChlKSA9PiB7XHJcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIHZhciBuZXdfbm8gPSBwYXJzZUludCgkKCcjdG90YWxfbWV0YScpLnZhbCgpKSArIDE7XHJcbiAgICAgICAgdmFyIG5ld19tZXRhID0gXCI8ZGl2IGlkPSdtZXRhX1wiICsgbmV3X25vICsgXCInICBjbGFzcz0naW5wdXQtZ3JvdXAnPlwiXHJcbiAgICAgICAgICAgICsgXCI8bGFiZWw+TmFtZTogPC9sYWJlbD4gPGlucHV0IHR5cGU9J3RleHQnIGlkPSdtZXRhTmFtZV9cIiArIG5ld19ubyArIFwiJyByZXF1aXJlZC8+IFwiXHJcbiAgICAgICAgICAgICsgXCI8bGFiZWw+Q29udGVudDogPC9sYWJlbD4gPGlucHV0IHR5cGU9J3RleHQnIGlkPSdtZXRhQ29udGVudF9cIiArIG5ld19ubyArIFwiJ3JlcXVpcmVkLz5cIlxyXG4gICAgICAgICAgICArIFwiPC9kaXY+XCI7XHJcbiAgICAgICAgJCgnI21ldGEtZ3JvdXAnKS5hcHBlbmQobmV3X21ldGEpO1xyXG5cclxuICAgICAgICAkKCcjdG90YWxfbWV0YScpLnZhbChuZXdfbm8pO1xyXG4gICAgfVxyXG4gICAgc2V0TWV0YVN0YXRlID0gKCkgPT4ge1xyXG4gICAgICAgIGxldCBuYW1lX2lucHV0cyA9ICQoXCJpbnB1dFtpZF49J21ldGFOYW1lXyddXCIpO1xyXG4gICAgICAgIGxldCBjb250ZW50X2lucHV0cyA9ICQoXCJpbnB1dFtpZF49J21ldGFDb250ZW50XyddXCIpO1xyXG4gICAgICAgIGxldCBodG1sTWV0YSA9IFsuLi50aGlzLnN0YXRlLmh0bWxNZXRhXTtcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG5hbWVfaW5wdXRzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGxldCBtZXRhID0geyBuYW1lOiAkKG5hbWVfaW5wdXRzW2ldKS52YWwoKSwgY29udGVudDogJChjb250ZW50X2lucHV0c1tpXSkudmFsKCkgfTtcclxuICAgICAgICAgICAgaHRtbE1ldGEucHVzaChtZXRhKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IGh0bWxNZXRhIH0pO1xyXG4gICAgICAgIGFsZXJ0KCdzYXZlZCcpO1xyXG4gICAgfVxyXG5cclxuICAgIHJlbW92ZSA9ICgpID0+IHtcclxuICAgICAgICB2YXIgbGFzdF9jaHFfbm8gPSAkKCcjdG90YWxfbWV0YScpLnZhbCgpO1xyXG5cclxuICAgICAgICBpZiAobGFzdF9jaHFfbm8gPiAxKSB7XHJcbiAgICAgICAgICAgICQoJyNtZXRhXycgKyBsYXN0X2NocV9ubykucmVtb3ZlKCk7XHJcbiAgICAgICAgICAgICQoJyN0b3RhbF9tZXRhJykudmFsKGxhc3RfY2hxX25vIC0gMSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHJlbmRlcigpIHtcclxuICAgICAgICBjb25zdCB7IGVkaXRvclN0YXRlIH0gPSB0aGlzLnN0YXRlO1xyXG4gICAgICAgIHJldHVybiAoXHJcbiAgICAgICAgICAgIDxmb3JtIG9uU3VibWl0PXt0aGlzLm9uU3VibWl0fT5cclxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaW5wdXQtZ3JvdXBcIj5cclxuICAgICAgICAgICAgICAgICAgICA8bGFiZWw+QWRkIHRpdGxlIGZvciB5b3VyIGJsb2c6IDwvbGFiZWw+XHJcbiAgICAgICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9XCJ0ZXh0XCIgdmFsdWU9e3RoaXMuc3RhdGUudGl0bGV9IG9uQ2hhbmdlPXt0aGlzLmhhbmRsZVRpdGxlQ2hhbmdlfSAvPlxyXG4gICAgICAgICAgICAgICAgICAgIHt0aGlzLnN0YXRlLnRpdGxlID8gPHAgY2xhc3NOYW1lPVwiaW5saW5lTWVzc2FnZV9fc3VjY2Vzc1wiPlNhdmVkITwvcD4gOiBudWxsfVxyXG4gICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImlucHV0LWdyb3VwXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgPGxhYmVsPkFkZCBkZXNjcmlwdGlvbiBmb3IgeW91ciBibG9nOiA8L2xhYmVsPlxyXG4gICAgICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPVwidGV4dFwiIHZhbHVlPXt0aGlzLnN0YXRlLmRlc2NyaXB0aW9ufSBvbkNoYW5nZT17dGhpcy5oYW5kbGVEZXNjcmlwdGlvbkNoYW5nZX0gLz5cclxuICAgICAgICAgICAgICAgICAgICB7dGhpcy5zdGF0ZS5kZXNjcmlwdGlvbiA/IDxwIGNsYXNzTmFtZT1cImlubGluZU1lc3NhZ2VfX3N1Y2Nlc3NcIj5TYXZlZCE8L3A+IDogbnVsbH1cclxuICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJpbnB1dC1ncm91cFwiPlxyXG4gICAgICAgICAgICAgICAgICAgIDxsYWJlbD5BZGQgeW91ciB0aHVtYm5haWwgZm9yIHlvdXIgYmxvZzogPC9sYWJlbD5cclxuICAgICAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT1cImZpbGVcIiBvbkNoYW5nZT17dGhpcy5oYW5kbGVUaHVtYk5haWxDaGFuZ2V9IC8+XHJcbiAgICAgICAgICAgICAgICAgICAge3RoaXMuc3RhdGUudGh1bWJuYWlsID8gPHAgY2xhc3NOYW1lPVwiaW5saW5lTWVzc2FnZV9fc3VjY2Vzc1wiPlNhdmVkITwvcD4gOiBudWxsfVxyXG4gICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImlucHV0LWdyb3VwXCIgaWQ9XCJtZXRhLWdyb3VwXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgPGxhYmVsPkFkZCBtZXRhIGRhdGEgZm9yIHlvdXIgYmxvZzogPC9sYWJlbD5cclxuICAgICAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT1cImhpZGRlblwiIHZhbHVlPVwiMVwiIGlkPVwidG90YWxfbWV0YVwiPjwvaW5wdXQ+XHJcbiAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBvbkNsaWNrPXt0aGlzLmFkZH0gY2xhc3NOYW1lPVwiYnV0dG9uIGJ1dHRvbi0tZGFya3BpbmsgYnV0dG9uLXNtYWxsXCI+QWRkPC9idXR0b24+XHJcbiAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBvbkNsaWNrPXt0aGlzLnJlbW92ZX0gY2xhc3NOYW1lPVwiYnV0dG9uIGJ1dHRvbi0tZGFya3BpbmsgYnV0dG9uLXNtYWxsXCI+UmVtb3ZlPC9idXR0b24+XHJcbiAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgIDxFZGl0b3JcclxuICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj1cIkNyZWF0ZSB5b3VyIGJsb2cgaGVyZS4uLi5cIlxyXG4gICAgICAgICAgICAgICAgICAgIGVkaXRvclN0YXRlPXtlZGl0b3JTdGF0ZX1cclxuICAgICAgICAgICAgICAgICAgICB3cmFwcGVyQ2xhc3NOYW1lPVwiZGVtby13cmFwcGVyXCJcclxuICAgICAgICAgICAgICAgICAgICBlZGl0b3JDbGFzc05hbWU9XCJkZW1vLWVkaXRvciBlZGl0b3ItYm9yZGVyXCJcclxuICAgICAgICAgICAgICAgICAgICBvbkVkaXRvclN0YXRlQ2hhbmdlPXt0aGlzLm9uRWRpdG9yU3RhdGVDaGFuZ2V9XHJcbiAgICAgICAgICAgICAgICAgICAgdG9vbGJhcj17e1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpbWFnZToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJldmlld0ltYWdlOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXBsb2FkRW5hYmxlZDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVwbG9hZENhbGxiYWNrOiB0aGlzLnVwbG9hZENhbGxiYWNrLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfX1cclxuICAgICAgICAgICAgICAgICAgICB0b29sYmFyU3R5bGU9e3tcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6ICdibGFjaycsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAnZml4ZWQnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZWZ0OiAnMTB2dycsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvcDogJzMwdmgnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogJzIwJSdcclxuICAgICAgICAgICAgICAgICAgICB9fVxyXG4gICAgICAgICAgICAgICAgLz5cclxuICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3NOYW1lPVwiYnV0dG9uIGJ1dHRvbi1waW5rd2hpdGVcIj5TYXZlIGJsb2c8L2J1dHRvbj5cclxuICAgICAgICAgICAgPC9mb3JtPlxyXG4gICAgICAgICk7XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IEJsb2dGb3JtO1xyXG5cclxuXHJcbi8vIDxpbnB1dCB0eXBlPVwiZmlsZVwiIG9uQ2hhbmdlPXt0aGlzLmhhbmRsZUZpbGVDaGFuZ2V9IC8+XHJcbi8vICAgICA8YnV0dG9uIG9uQ2xpY2s9e3RoaXMuYWRkRmlsZX0+VXBsb2FkPC9idXR0b24+XHJcblxyXG4vLyBjb25zdHJ1Y3Rvcihwcm9wcykge1xyXG4vLyAgICAgc3VwZXIocHJvcHMpO1xyXG5cclxuLy8gICAgIHRoaXMuc3RhdGUgPSB7XHJcbi8vICAgICAgICAgaHRtbFNlY3Rpb25zOiAnJyxcclxuLy8gICAgICAgICBmaWxlOiAnJyxcclxuLy8gICAgIH1cclxuLy8gfVxyXG5cclxuLy8gb25FZGl0b3JTdGF0ZUNoYW5nZSA9ICh2YWx1ZSkgPT4ge1xyXG4vLyAgICAgdGhpcy5zZXRTdGF0ZSh7IGh0bWxTZWN0aW9uczogdmFsdWUgfSlcclxuLy8gICAgIGNvbnNvbGUubG9nKHRoaXMuc3RhdGUuaHRtbFNlY3Rpb25zKVxyXG4vLyB9XHJcblxyXG4vLyBoYW5kbGVGaWxlQ2hhbmdlID0gZSA9PiB7XHJcbi8vICAgICBlLnByZXZlbnREZWZhdWx0KClcclxuLy8gICAgIGxldCBmaWxlID0gZS50YXJnZXQuZmlsZXNbMF07XHJcbi8vICAgICB0aGlzLnNldFN0YXRlKHsgZmlsZSB9KVxyXG4vLyB9XHJcblxyXG4vLyBhZGRGaWxlID0gKGUpID0+IHtcclxuLy8gICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuLy8gICAgIGNvbnN0IHsgZmlsZSB9ID0gdGhpcy5zdGF0ZTtcclxuLy8gICAgIGNvbnN0IHVwbG9hZFRhc2sgPSBzdG9yYWdlLnJlZihgaW1hZ2VzLyR7ZmlsZS5uYW1lfWApLnB1dChmaWxlKTtcclxuLy8gICAgIHVwbG9hZFRhc2sub24oJ3N0YXRlX2NoYW5nZWQnLCBzbmFwc2hvdCA9PiB7XHJcblxyXG4vLyAgICAgfSwgZXJyb3IgPT4ge1xyXG4vLyAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTtcclxuLy8gICAgIH0sICgpID0+IHtcclxuLy8gICAgICAgICBzdG9yYWdlLnJlZignaW1hZ2VzJykuY2hpbGQoZmlsZS5uYW1lKS5nZXREb3dubG9hZFVSTCgpLnRoZW4odXJsID0+IHtcclxuLy8gICAgICAgICAgICAgbGV0IGh0bWxTZWN0aW9ucyA9IHRoaXMuc3RhdGUuaHRtbFNlY3Rpb25zICsgJzxpbWcgc3JjPVwiJyArIHVybCArICdcIi8+J1xyXG4vLyAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKHsgaHRtbFNlY3Rpb25zIH0pO1xyXG4vLyAgICAgICAgIH0pXHJcbi8vICAgICB9KVxyXG4vLyB9XHJcblxyXG4vLyByZW5kZXIoKSB7XHJcbi8vICAgICByZXR1cm4gKFxyXG4vLyAgICAgICAgIDxkaXY+XHJcbi8vICAgICAgICAgICAgIDxFZGl0b3JcclxuLy8gICAgICAgICAgICAgICAgIGVkaXRvclN0YXRlPXt0aGlzLnN0YXRlLmh0bWxTZWN0aW9uc31cclxuLy8gICAgICAgICAgICAgICAgIHRvb2xiYXJDbGFzc05hbWU9XCJ0b29sYmFyQ2xhc3NOYW1lXCJcclxuLy8gICAgICAgICAgICAgICAgIHdyYXBwZXJDbGFzc05hbWU9XCJ3cmFwcGVyQ2xhc3NOYW1lXCJcclxuLy8gICAgICAgICAgICAgICAgIGVkaXRvckNsYXNzTmFtZT1cImVkaXRvckNsYXNzTmFtZVwiXHJcbi8vICAgICAgICAgICAgICAgICBvbkVkaXRvclN0YXRlQ2hhbmdlPXt0aGlzLm9uRWRpdG9yU3RhdGVDaGFuZ2V9XHJcbi8vICAgICAgICAgICAgIC8+XHJcbi8vICAgICAgICAgPC9kaXY+XHJcbi8vICAgICApXHJcbi8vIH0iXSwic291cmNlUm9vdCI6IiJ9